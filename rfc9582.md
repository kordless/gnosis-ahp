```markdown
Internet Engineering Task Force (IETF)
M. Consortium
Request for Comments: 9582
Category: Best Current Practice
August 2025

# BCP for Agentic Interactions over HTTP

## Abstract

This document describes a set of best practices for facilitating interactions between automated software agents (AI agents) using the Hypertext Transfer Protocol (HTTP). As agentic systems proliferate, they frequently utilize HTTP in ad-hoc ways, leading to interoperability challenges. This document proposes a minimalist, standardized framework based on existing HTTP semantics to promote a more cohesive and efficient ecosystem. The primary recommendation involves formalizing the usage of the `402 (Payment Required)` status code to enable native economic exchange, with a specific focus on Bitcoin's Lightning Network as a reference implementation.

## Status of This Memo

This memo documents a Best Current Practice for the Internet community. It does not specify an Internet standard of any kind. Distribution of this memo is unlimited.

## 1. Introduction

Autonomous software agents increasingly rely on HTTP to interact with external tools and services. However, the lack of a standardized interaction pattern has resulted in a fragmented landscape where each service requires a bespoke integration.

This document outlines a Best Current Practice (BCP) for designing agent-facing services that leverages the fundamental simplicity and robustness of HTTP. The goal is to reduce complexity, eliminate the need for heavyweight SDKs, and foster an open ecosystem. These recommendations codify successful patterns observed in emerging agentic frameworks (e.g., the Agentic Hypercall Protocol).

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC 2119.

## 2. Recommendations for Agentic Interaction

### 2.1. Idempotent Tool Invocation via GET

To ensure safety, predictability, and cacheability, services intended for agentic consumption SHOULD expose all idempotent, read-only, or state-retrieving actions as `HTTP GET` methods. Parameters required for the action SHOULD be passed as URL query string parameters. This simple "Hypercall" pattern is the foundation of interoperable agentic action.

### 2.2. Service Discovery

To facilitate automated discovery of available tools, agent-facing servers SHOULD provide a machine-readable definition of their services. It is RECOMMENDED that an OpenAPI 3.0+ specification be made available at the well-known URI path: `/.well-known/openapi.json`.

## 3. Addendum: Standardizing the 402 (Payment Required) Status Code

The `402 (Payment Required)` status code was originally reserved for future use. This document proposes a concrete application for it as the primary mechanism for signaling cost and requesting payment in automated, agent-driven workflows.

### 3.1. The 402 Response Payload

When an agent requests a resource that requires payment, the server SHOULD return a `402` status code. The response body **MUST** be a JSON object containing details of the required payment.

The JSON object SHOULD contain the following keys:
*   `cost`: A string representing the decimal amount required for the service.
*   `currency`: A string identifying the ledger or currency type (e.g., "USD", "EUR", "BTC-LN"). This helps the agent determine if it can use a supported payment method.
*   `destination`: A string containing the payment address or invoice. For example, for Bitcoin's Lightning Network, this would be the BOLT 11 invoice.
*   `description`: A human-readable string explaining the charge (OPTIONAL).

*Example 402 Response for Bitcoin Lightning Network:*
```http
HTTP/1.1 402 Payment Required
Content-Type: application/json

{
  "cost": "100",
  "currency": "BTC-LN",
  "destination": "lnbc10u1p3z2y7xpp5j3c2y...",
  "description": "API call to /longer_qr_code"
}
```

### 3.2. Client Behavior

Upon receiving a `402` response, an agent can parse the body to decide if the cost is acceptable and if it possesses the means to pay in the requested currency. If it proceeds with payment, it can then retry the original `HTTP GET` request, including proof of payment as specified by the service.

For a Lightning Network payment, the agent would typically:
1.  Pay the BOLT 11 invoice.
2.  Retry the original request, adding the `invoice_id` as a query parameter.

*Example Retry Request:*
```
GET /longer_qr_code?data=...&invoice_id=...&bearer_token=...
```

The server is then responsible for verifying the payment status of the `invoice_id` before executing the tool.

## 4. Rationale

Standardizing these simple patterns provides immense benefits. It lowers the barrier to entry for new tool creators, allows agents to seamlessly switch between service providers, and creates a transparent, native economic layer for the machine economy. By formalizing the use of the `402` code, we avoid the need for complex, out-of-band billing APIs and instead embed commerce directly into the protocol where it belongs.

## 5. IANA Considerations

This BCP recommends a specific structure for the payload of an `HTTP 402` response. While this does not require a new registry, future work may propose the creation of a registry for common "currency" identifiers to promote interoperability between different payment ledgers and systems.

## 6. Security Considerations

Standardizing agentic interactions requires careful security design. Service providers must protect against denial-of-service attacks and validate all inputs from agents. Agents must protect their payment credentials and verify the identity of the services they interact with, typically via TLS. Authentication mechanisms, such as OAuth 2.0 or bearer tokens, remain essential for protected resources.
```
